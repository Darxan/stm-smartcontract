# Аудит смарт контрактов Streamity crowdsale.

Статус - в работе

## Общие замечания

Код контрактов проверен на предмет программных закладок и критических ошибок спобоных привести к потере денег инвесторами.

* В контракте StreamityCrowdsale присутсвуют критические ошибки, из за которых код не будет работать как ожидается: при выставлении значения минимальной инвестиции в 0.1 эфира, контракт не будет принимать сумму менее 1 эфира. 

* Присутствует возможность пересылки токенов до периода окончания ICO. Наличие бонусных периодов, позволяет держателям продавать купленные ранее токены во время ICO по цене ниже, чем в контракте.

Распродажа токенов Streamity осуществляется через контракт StreamityContract, он наследует функционал контрактов токена TokenERC20 и ERC20Extending, контракта распродажи StreamityCrowdsale, а так же Ownable - реализующего механизм владения контрактом и Pauseble - позволяющиго поставить распродажу на паузу. Некоторые контракты используют методы библиотеки MathLib для безопасных вычислений.

## Обзор контрактов

TokenERC20

1) (Примечание) Вся эмиссия токенов указывается при деплое контракта (без учета десятичной части), дополнительная эмиссия не предусмотрена.
2) (Примечание) Контракт токена имитирует монеты на собственный адрес.
3) (Незначительное) Избыточная операция в конструкторе: owner = msg.sender.
4) (Среднее) Библиотека SafeMath подключена, но в большинстве операций не используется.
5) (Важно) Нет ограгичений по отправке (покупке/продаже) токенов на период проведения ICO (с учетом того, что в данном ICO предусмотрены периоды со скидками, покупатель может купить токены со скидкой и с профитом перепродать их на следующих периодах по более низкой, чем установленная в контракте, цене.
6) (Примечание) Сжигание монет может производиться только владельцем контракта со своего собственного баланса или с баланса держателя, который разрешил владельцу контракта потратить соответствующее количество токенов со воего счета.

ERC20Extending

1) (Примечание) Владелец контракта может оправить любое имеющееся количество эфиров с баланса контракта на любой адрес.
2) (Примечание) Владелец контракта может оправить любое имеющееся количество токенов с баланса контракта на любой адрес.

Pauseble

1) (Примечание) Контракт содержит функционал, позволяющий его владельцу переключать триггер paused во включеное и выключеное положение, и модификаторы позволяющие вызов некоторых функций только в режиме паузы или только в режиме вне паузы.
2) (Незначительное) Переменная startIcoDate объявлена, но не используется в данном контракте: целесообразнее объявить ее в том котракте, где она используется непосредственно.

StreamityCrowdsale

1) (Критично) Функция sell не позволяет реализовать продажу токена менее чем за 1 эфир из за неправильной записи арефмитических операций.
2) (Незначительно) Библиотека SafeMath подключена, но используется не везде.
3) (Примечание) Владелец контракта в любой мемент может поменять стоимость распродажи токена контрактом.
4) (Незначительно) Функция crowdSaleStatus возвращает строковое значание статуса рпспродажи, в большинстве случаев оптимальнее вывадить закодированное числовое значение для экономии газа.
5) (Примечание) Функция sell отвечает за отправку токенов на указынный адрес, первоначальное количество токенов передается параметром, затем в соответствии с текущим периодом распродажи расчитывается количество токенов с боносум, которое отсылается на указанный параметром адрес.
6) (Примечание) Бонусные токены предусмотрены тольео для первого, второго и третьего периода распродажи. В первый день второго периода предусмотрен дополнительный бонус: его значение в случае равенства 0 увеличивается до 20% от количества отправляемых токенов.
7) (Среднее) Каждый этап распродажи стартует с вызовом функции startCrowd владельцем контракта, предыдущий этап завершается либо по истечении количества дней, указанного в параметре _endDate функции startCrowd, либо при следующем вызове startCrowd.

StreamityContract

1) (Важно) В функции, отвечающей за прием эфира на счет контракта установлено ограничение минимальной транзакции в 0.1 эфира, но при попытке отправить эфира на сумму меньше 1 будет возникать ошибка в функции sell.
2) (Не критично) Рекомендую добавить в контракт публичную переменную, отобоажающую сколько всего эфиров собрал контракт. Данная переменная позволит отслеживать сколько всего собрано денег через контракт и выводить эту информацию в dapp. (добавлено).

MathLib

1) (Не критично) Использование оператора require вместо assert позволит съэкономить газ в случае ошибочных вычислений в методах контракта.

Контракт Migrations не связан с остальными контрактами.

## Предупреждение об ответственности

Этот аудит касается только исходных кодов смарт контрактов и не должен рассматриваться как одобрение платформы, команды или компании.

## Авторы

Аудит проведен Вячеславом Поскониным - https://github.com/EthereumWorks/, по вопросам проведения аудитов и разработки смарт контрактов обращайтесь: Telegram - @SlavaPoe, Skype - v.poskonin (MousePo).
